<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>GLB Compressor</title>

<script type="module">
import { WebIO } from 'https://cdn.jsdelivr.net/npm/@gltf-transform/core@3.10.0/dist/web.js';
import { textureResize, dedup, prune } from 'https://cdn.jsdelivr.net/npm/@gltf-transform/functions@3.10.0/dist/functions.js';

window.compress = async function () {

const file = document.getElementById("file").files[0];
if(!file) return alert("Upload GLB first");

const io = new WebIO();
const arrayBuffer = await file.arrayBuffer();

const doc = await io.readBinary(new Uint8Array(arrayBuffer));

await doc.transform(
dedup(),
prune(),
textureResize({ size: [1024,1024] }) // texture resize = size reduce
);

const optimized = await io.writeBinary(doc);
const blob = new Blob([optimized],{type:"model/gltf-binary"});
const url = URL.createObjectURL(blob);

const link = document.getElementById("download");
link.href = url;
link.style.display="block";
}
</script>

<style>
body{
background:#111;
color:white;
font-family:sans-serif;
text-align:center;
padding:20px;
}
input,button,a{
margin:10px;
padding:10px;
border-radius:10px;
border:none;
}
button{
background:#00ffcc;
cursor:pointer;
}
a{
background:#ffcc00;
color:black;
text-decoration:none;
display:none;
}
</style>
</head>

<body>

<h2>ðŸ”¥ GLB File Size Reducer</h2>

<input type="file" id="file" accept=".glb">
<br>
<button onclick="compress()">Compress</button>
<br>
<a id="download" download="optimized.glb">Download Optimized GLB</a>

</body>
</html>